const app=document.getElementById("app");function canvas(){const t=document.createElement("canvas");let e=t.width=window.innerWidth,i=t.height=window.innerHeight;const a=t.getContext("2d"),h={len:30,count:50,baseTime:10,addedTime:10,dieChance:.05,spawnChance:1,sparkChance:.1,sparkDist:10,sparkSize:2,color:"hsl(hue,100%,light%)",baseLight:50,addedLight:10,shadowToTimePropMult:6,baseLightInputMultiplier:.01,addedLightInputMultiplier:.02,cx:e/2,cy:i/2,repaintAlpha:.04,hueChange:2};let n=0;const s=[];let d=e/2/h.len,l=i/2/h.len;const o=2*Math.PI/6;function r(){this.reset()}app.append(t),a.fillStyle="#000",a.fillRect(0,0,e,i),r.prototype.reset=function(){this.x=0,this.y=0,this.addedX=0,this.addedY=0,this.rad=0,this.lightInputMultiplier=h.baseLightInputMultiplier+h.addedLightInputMultiplier*Math.random(),this.color=h.color.replace("hue",n*h.hueChange),this.cumulativeTime=0,this.beginPhase()},r.prototype.beginPhase=function(){this.x+=this.addedX,this.y+=this.addedY,this.time=0,this.targetTime=h.baseTime+h.addedTime*Math.random()|0,this.rad+=o*(Math.random()<.5?1:-1),this.addedX=Math.cos(this.rad),this.addedY=Math.sin(this.rad),(Math.random()<h.dieChance||this.x>d||this.x<-d||this.y>l||this.y<-l)&&this.reset()},r.prototype.step=function(){++this.time,++this.cumulativeTime,this.time>=this.targetTime&&this.beginPhase();const t=this.time/this.targetTime,e=Math.sin(t*Math.PI/2),i=this.addedX*e,n=this.addedY*e;a.shadowBlur=t*h.shadowToTimePropMult,a.fillStyle=a.shadowColor=this.color.replace("light",h.baseLight+h.addedLight*Math.sin(this.cumulativeTime*this.lightInputMultiplier)),a.fillRect(h.cx+(this.x+i)*h.len,h.cy+(this.y+n)*h.len,2,2),Math.random()<h.sparkChance&&a.fillRect(h.cx+(this.x+i)*h.len+Math.random()*h.sparkDist*(Math.random()<.5?1:-1)-h.sparkSize/2,h.cy+(this.y+n)*h.len+Math.random()*h.sparkDist*(Math.random()<.5?1:-1)-h.sparkSize/2,h.sparkSize,h.sparkSize)},function t(){window.requestAnimationFrame(t),++n,a.globalCompositeOperation="source-over",a.shadowBlur=0,a.fillStyle=`rgba(0,0,0,${h.repaintAlpha})`,a.fillRect(0,0,e,i),a.globalCompositeOperation="lighter",s.length<h.count&&Math.random()<h.spawnChance&&s.push(new r),s.map(function(t){t.step()})}(),window.addEventListener("resize",function(){e=t.width=window.innerWidth,i=t.height=window.innerHeight,a.fillStyle="#000",a.fillRect(0,0,e,i),h.cx=e/2,h.cy=i/2,d=e/2/h.len,l=i/2/h.len})}canvas();
